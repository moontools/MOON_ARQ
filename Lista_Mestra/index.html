<!DOCTYPE html>
<!--
    Formulário de Lista Mestra
-->
<html lang="pt-br" ng-app="listaMestra">
    <head>
        <title>Lista Mestra</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <!--Google Drive API-->  
        <script src="https://apis.google.com/js/client.js?onload=handleClientLoad" type="text/javascript"></script>
        
        <!--Angular JS-->
        <script src="../bower_components/angular/angular.min.js" type="text/javascript"></script>
       
         <!--Bootstrap--> 
        <!--<link rel="stylesheet" media="screen" href="css/bootstrap.css" />-->
        <link href="../bower_components/bootstrap/dist/css/bootstrap.css"  rel="stylesheet" media="screen"/>
        
        <link rel="shortcut icon" type="image/png" href="images/gif_moontools_reducido.gif"/>

        <!--JS Ui Boostrat-->
        <script src="../bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js" type="text/javascript"></script> 
        

        <!--<link rel="stylesheet" media="screen" href="lib/angular-toggle-switch.css"/>-->
        <link rel="stylesheet" media="screen" href="../bower_components/angular-bootstrap-toggle-switch/style/bootstrap3/angular-toggle-switch-bootstrap-3.css"/>
        <script src="../bower_components/angular-bootstrap-toggle-switch/angular-toggle-switch.js" type="text/javascript"></script>
                        
         <!--Modal Services--> 
        <link   href="../bower_components/angular-dialog-service/dist/dialogs.min.css" rel='stylesheet' media="screen"/>
        <script src="../bower_components/angular-sanitize/angular-sanitize.min.js"></script>
        <script src="../bower_components/angular-translate/angular-translate.min.js "></script>
        <script src="../bower_components/angular-dialog-service/dist/dialogs-default-translations.min.js" type="text/javascript"></script>
        <script src="../bower_components/angular-dialog-service/example/js/dialogs.min.js" type="text/javascript"></script>
        <script src="../bower_components/angular-locale-pt-br/angular-locale_pt-br.js" type="text/javascript"></script>
        <script src="../bower_components/angular-input-masks/angular-input-masks-standalone.min.js" type="text/javascript"></script>
 
        <!--JS da aplicação-->
        <script src="js/app.js" type="text/javascript"></script>
        <script src="js/controllers.js" type="text/javascript"></script>
        <script src="js/services.js" type="text/javascript"></script>
        
        <!--Libs Moontools-->
        <script src="js/mtlGdrive.js" type="text/javascript"></script>
        <script src="js/mtlGoogleSheet.js" type="text/javascript"></script>
        <script src="js/mtlAcessos.js" type="text/javascript"></script>
        <script src="js/mtlUtil.js" type="text/javascript"></script>

        <!--Estilos próprios--> 
        <link rel="stylesheet" media="screen" href="css/styles.css"/> 
    </head>
  

    <body ng-controller="formListaMestra">
        <div id="loading-div-background" ng-show="spinerloading">
            <div id="loading-div" class="ui-corner-all" >
                    <img src="images/gif_moontools_reducido.gif" alt="Loading.."/>
                    <h2 id="mensageLoading">{{messageLoading}}</h2>
            </div> 
        </div>
                        
        <div class="container" ng-hide="spinerloading">
            <!-- Cabeçalho do formulário -->
            <div class="jumbotron">
                <h2>Lista Mestra</h2>
                <!-- Descrição do Formulário -->
                <small>Formulário para inserção de documentos da Lista Mestra!</small>
            </div>
            
            <small class='required_notification'>* Campos obrigatórios</small>
            <!-- Inicio Inputs -->
            <form name="formListaMestra" novalidate ng-submit="salvar()" >
                                                           
                    <!-- Email -->
                    <div class="form-group" ng-class="{ 'has-error' : formListaMestra.usuario.$invalid || !params.acesso}">      
                        <label class="control-label">Usuário </label>
                        <small class="help-block" ng-show="formListaMestra.usuario.$invalid || !params.acesso">{{params.erroAcesso}}</small>
                        <input type="email"
                               name="usuario"
                               class="form-control"
                               ng-model="registro.usuario" 
                               required
                               ng-disabled="true"
                               ng-pattern="/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/">
                    </div> 
                    <!-- Fim e-mail -->

                    <!-- Código documento -->
                    <div class="form-group">      
                        <label class="control-label">Código documento </label>
                        <small class="help-block"></small>
                        <input type="text"
                               name="codigo"
                               class="form-control" 
                               ng-model="registro.codigo"
                               ng-disabled="true">
                    </div> 
                    <!-- Fim código documento -->
                    
                    <!-- Revisão documento -->
                    <div class="form-group">      
                        <label class="control-label">Revisão documento </label>
                        <small class="help-block"></small>
                        <input type="text"
                               name="revisao"
                               class="form-control" 
                               ng-model="registro.revisao"
                               ng-disabled="true">
                    </div> 
                    <!-- Fim código documento -->
                                        
                    <!-- Cliente  -->
                    <div class="form-group">      
                        <label class="control-label">Cliente </label>
                        <small class="help-block"></small>
                        <input type="text"
                               name="cliente"
                               class="form-control"
                               ng-model="registro.cliente"
                               ng-disabled="true">
                    </div> 
                    <!-- Fim Cliente --
                    
                    <!-- Empreendimento  -->
                    <div class="form-group">      
                        <label class="control-label">Empreendimento </label>
                        <small class="help-block"></small>
                        <input type="text"
                               name="empreendimento"
                               class="form-control"
                               ng-class="{'spinner' : !params.blocos}"
                               ng-model="registro.empreendimento"
                               ng-disabled="true">
                    </div> 
                    <!-- Fim Empreendimento -->  
                    
                    <!-- Projeto -->
                    <div class="form-group" ng-class="{ 'has-error' : formListaMestra.projeto.$invalid && !formListaMestra.projeto.$pristine}">      
                        <label class=" control-label">Projeto </label>
                        <small class="help-block" ng-show="formListaMestra.projeto.$invalid && !formListaMestra.projeto.$pristine">Selecione um projeto</small>
                        <select name="projeto"
                                ng-options="projeto[0] as projeto[0] for projeto in params.projeto"
                                class="form-control"
                                ng-class="{'spinner' : !params.projeto || (formListaMestra.projeto.$valid && !formListaMestra.projeto.$pristine && !params.complemento)}"
                                ng-model="registro.projeto"
                                ng-change="showComplementos()"
                                required>
                            <option></option>
                        </select>
                    </div> 
                    <!-- Fim Projeto -->
                    
                    <!-- Complemento -->
                    <div class="form-group animated" ng-class="{'fadeIn' : params.complemento.length > 0}" ng-show="params.complemento.length > 0" ng-class="{ 'has-error' : formListaMestra.complemento.$invalid && !formListaMestra.complemento.$pristine}">      
                        <label class="control-label">Complemento </label>
                        <small class="help-block" ng-show="formListaMestra.complemento.$invalid && !formListaMestra.complemento.$pristine">Selecione um complemento</small>
                        <select name="complemento"
                                ng-options="complemento as complemento for complemento in params.complemento"
                                class="form-control"
                                ng-class="{'spinner' : !params.complemento || (formListaMestra.complemento.$valid && !formListaMestra.complemento.$pristine && !params.detalhamento)}"
                                ng-model="registro.complemento"
                                ng-required="registro.complemento"
                                ng-change="showDetalhamentos()">
                            <option></option>
                        </select>
                    </div> 
                    <!-- Fim Complemento -->
                    
                    <!-- Detalhamento -->
                    <div class="form-group animated" ng-class="{'fadeIn' : params.detalhamento.length > 0}" ng-show="params.detalhamento.length > 0" ng-class="{ 'has-error' : formListaMestra.detalhamento.$invalid && !formListaMestra.detalhamento.$pristine}">      
                        <label class="control-label">Detalhamento </label>
                        <small class="help-block" ng-show="formListaMestra.detalhamento.$invalid && !formListaMestra.detalhamento.$pristine">Selecione um detalhamento</small>
                        <select name="detalhamento"
                                ng-options="detalhamento as detalhamento for detalhamento in params.detalhamento"
                                class="form-control"
                                ng-class="{'spinner' : !params.detalhamento}"
                                ng-model="registro.detalhamento" 
                                ng-required = "params.detalhamento.length > 0">
                            <option></option>
                        </select>
                    </div> 
                    <!-- Fim Detalhamento -->
                    
                    <!--Outro Detalhamento-->
                    <div class="form-group animated" ng-class="{'fadeIn' : registro.detalhamento == 'OUTRO'}" ng-show="registro.detalhamento == 'OUTRO'" ng-class="{ 'has-error' : formListaMestra.outroDetalhamento.$invalid && !formListaMestra.outroDetalhamento.$pristine}">
                        <label class="control-label">Descreva o detalhamento </label>
                        <input type="text"
                               capitalize
                               name="outroDetalhamento"
                               class="form-control" 
                               ng-model="registro.outroDetalhamento"
                               ng-required="registro.detalhamento == 'OUTRO'">
                    </div>
                    <!--FIM Outro Detalhamento-->
                    
                    <!-- Número Grupo Prancha -->
                    <div class="form-group">      
                        <label class="control-label">Nº grupo prancha </label>
                        <small></small>
                        <input type="text"
                               placeholder="Insira o número do grupo de pranchas"
                               class="form-control" 
                               ng-model="registro.nGrupoPranchas"
                               capitalize
                               ng-required="registro.nGrupoPranchas || registro.numeroPrancha">
                    </div> 
                    <!-- Fim Número Grupo PranchaS -->
                    
                    <!--Bloco-->
                    <div class="form-group animated" ng-class="{'fadeIn' : params.bloco}" ng-show="params.blocos">
                        <label class="control-label">Blocos</label>
                        <div class="checkbox" ng-if="params.blocos !== '%loading%'" >
                            <label ng-repeat="bloco in params.blocos" style="padding-right: 20px">
                                <input type="checkbox" ng-model="registro.blocos[bloco]"/>
                                {{bloco}}
                            </label>
                        </div>
                        <small></small>
                    </div>
                    <!--FIM Bloco-->
                    
                    <!-- Número Prancha -->
                    <div class="form-group" ng-class="{ 'has-error' : formListaMestra.numeroPrancha.$invalid && !formListaMestra.numeroPrancha.$pristine}"> 
                        <label class=" control-label">Número prancha </label>
                        <small class="help-block" ng-show="formListaMestra.numeroPrancha.$invalid && !formListaMestra.numeroPrancha.$pristine">Informe somente números</small>
                        <input type="number"
                               name="numeroPrancha"
                               placeholder="Insira o número da prancha"
                               class="form-control" 
                               ng-model="registro.numeroPrancha"
                               ng-required="registro.nGrupoPranchas">
                    </div> 
                    <!-- Fim Número Prancha -->
                                                          
                    <!-- Responsável Técnico -->
                    <div class="form-group" ng-class="{ 'has-error' : formListaMestra.responsavelTecnico.$invalid && !formListaMestra.responsavelTecnico.$pristine}">   
                        <label class="control-label">Responsável técnico </label>
                        <small class="help-block" ng-show="formListaMestra.responsavelTecnico.$invalid && !formListaMestra.responsavelTecnico.$pristine">Selecione o responsável tecnico</small>
                        <select name="responsavelTecnico"
                                ng-options="responsavelTecnico as responsavelTecnico for responsavelTecnico in params.responsavelTecnico"
                                class="form-control"
                                ng-class="{'spinner' : !params.responsavelTecnico}"
                                ng-model="registro.responsavelTecnico" 
                                required>
                            <option></option>
                        </select>
                    </div> 
                    <!-- Fim Responsável Ténico -->
                    
                    <!-- Data documento -->
                    <div class="form-group">      
                        <label class="control-label">Data documento </label>
                        <small class="help-block"></small>
                        <p class="input-group">
                            <input type="text" 
                                   class="form-control" 
                                   datepicker-popup="dd/MM/yyyy"
                                   value="{{registro.dataDocumento | date:dd/MM/yyyy}}"
                                   ng-model="registro.dataDocumento"
                                   show-weeks="false"
                                   is-open="opened" 
                                   current-text="Hoje"
                                   clear-text="Limpar"
                                   close-text="Fechar"
                                   ng-required="true"
                                   maxlength="10"
                                   required/>
                            <span class="input-group-btn">
                                <button type="button" class="btn btn-default" ng-click="openCalendar($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                            </span>
                        </p>
                    </div> 
                    <!-- Fim Data documento -->
                    
                    <!-- Radio Servidor Terra -->
                    <div class="form-group">
                        <label class=" control-label">Servidor terra</label>
                        <small class="help-block">Indique se o arquivo esta no servidor terra</small>
                        <div class="btn-group-sm">
                            <toggle-switch
                                model="buttons.ServidorTerra"
                                class="switch-success"
                                on-label="Sim"
                                off-label="Não">
                            </toggle-switch>
                        </div>
                    </div>
                    <!-- Fim Radio Servidor Terra -->
                    
                    <!-- Pasta Física Terra -->
                    <div class="form-group">
                        <label class="control-label">Pasta física terra</label>
                        <small class="help-block">Indique se o arquivo esta na pasta física do Terra</small>
                        <small></small>
                        <div class="btn-group-sm">
                            <toggle-switch
                                model="buttons.PastaFisicaCliente"
                                class="switch-success"
                                on-label="Sim"
                                off-label="Não">
                            </toggle-switch>
                        </div>
                    </div>
                    <!-- Fim Pasta Física Terra -->

                    <!-- Pasta Física Cliente -->
                    <div class="form-group">
                        <label class="control-label">Pasta física cliente</label>
                        <small class="help-block">Indique se o arquivo esta na pasta física do cliente</small>
                            <div class="btn-group-sm">
                                <toggle-switch
                                    model="buttons.PastaFisicaTerra"
                                    class="switch-success"
                                    on-label="Sim"
                                    off-label="Não">
                                </toggle-switch>
                            </div>
                    </div>
                    <!-- Fim Pasta Física Cliente -->                  
                    
                    <!-- Arquivo Editavel -->
                    <div class="form-group">      
                        <label class=" control-label">Arquivo editável </label>
                        </br>
                        <small class="help-block" ng-show="registro.codigo && params.arquivoEditavel">                        
                            <a href="{{params.arquivoEditavel}}" target="_blank">{{registro.nomeDocumento}}</a>
                            -> Link do atual documento.
                        </small>
                        <input type="file"
                               name="arquivoEditavel"
                               ng-change="changeFile()"
                               class="form-control" 
                               fileread="registro.arquivoEditavel"
                               ng-model="registro.arquivoEditavel"
                               ng-required="(!registro.codigo && registro.nGrupoPranchas) || registro.arquivoEditavel || registro.arquivoImpressao"/>
                    </div>
                    <!-- Fim Arquivo Editavel -->
                    
                    
                    <!-- Arquivo Impressão -->
                    <div class="form-group">      
                        <label class="control-label">Arquivo impressão </label>
                        <small class="help-block" ng-show="registro.codigo && params.arquivoImpressao">                        
                            <a href="{{params.arquivoImpressao}}" target="_blank">{{registro.nomeDocumento}}</a>
                            -> Link do atual documento.
                        </small>
                        <input type="file"
                               name="arquivoImpressao"
                               class="form-control" 
                               fileread="registro.arquivoImpressao"
                               ng-model="registro.arquivoImpressao"
                               ng-required="registro.arquivoEditavel || registro.arquivoImpressao"/>
                    </div>
                    <!-- Fim Arquivo Impressão -->

                    <!-- Arquivo PDF -->
                    <div class="form-group">      
                        <label class=" control-label">Arquivo PDF </label>
                        <small class="help-block" ng-show="registro.codigo && params.arquivoPdf">                        
                            <a href="{{params.arquivoPdf}}" target="_blank">{{registro.nomeDocumento}}</a>
                            -> Link do atual documento.
                        </small>
                        <input type="file"
                               name="arquivoPdf"
                               class="form-control"
                               fileread="registro.arquivoPdf"
                               ng-model="registro.arquivoPdf"
                               ng-required="!registro.codigo || registro.arquivoEditavel || registro.arquivoPdf"/>
                    </div>
                    <!-- Fim Arquivo PDF -->
                    
                    <!-- Valor pagamento -->
                    <div class="form-group"> 
                        <label class=" control-label">Valor pagamento </label>
                        <small class="help-block" ></small>
                        <input type="text"
                               placeholder="R$ 0,00"
                               ui-money-mask
                               name="valorPagamento"
                               class="form-control" 
                               ng-model="registro.valorPagamento"
                               ng-required="registro.valorPagamento || registro.comprovantePagamento" >
                    </div> 
                    <!-- Fim Valor pagamento -->
                    
                    
                    <!-- Comprovante pagamento -->
                    <div class="form-group">      
                        <label class=" control-label">Comprovante pagamento </label>
                        <small class="help-block" ng-show="registro.codigo && params.comprovantePagamento">
                            <a href="{{params.comprovantePagamento}}" target="_blank">{{registro.nomeDocumento}}</a>
                            -> Link do atual documento.
                        </small>
                        <input type="file"
                               name="comprovantePagamento"
                               class="form-control"
                               fileread="registro.comprovantePagamento"
                               ng-model="registro.comprovantePagamento"
                               ng-required="!registro.codigo && registro.valorPagamento"/>
                    </div>
                    <!-- Comprovante pagamento -->
                    
                    
                    <!-- Observações -->
                    <div class="form-group">      
                        <label class="control-label">Observações</label>
                            <textarea class="form-control"
                                      capitalize
                                      ng-model="registro.observacoes"
                                      ng-required="registro.codigo || registro.observacoes"
                                      placeholder="{{registro.codigo ? 'Descreva as modificações desta nova revisão' : ''}}">
                            </textarea>
                    </div> 
                    <!-- Fim Observações-->
                    
                    <!-- Notificar Cliente -->
                    <div class="form-group">
                        <label class="control-label">Notificar cliente</label>
                        <small class="help-block">Indique se você quer notificar o cliente sobre este documento</small>
                        <div class="btn-group-sm">
                            <toggle-switch
                                model="buttons.NotificarCliente"
                                class="switch-success"
                                on-label="Sim"
                                off-label="Não">
                            </toggle-switch>
                        </div>
                    </div>
                    <!-- Fim Notificar Cliente -->                 
                    
                    
                    <!-- Botão Salvar -->
                    <div class="form-group">
                        <label class="control-label"></label>
                            <button type="submit" class="btn btn-primary" ng-disabled="formListaMestra.$invalid" >
                                Salvar
                            </button>
<!--                            <button type="button" class="btn btn-primary" ng-click="teste()" >
                                Testar
                            </button>
                            <button type="button" class="btn btn-primary" ng-click="teste2()" >
                                Testar 2
                            </button>-->
                        
                    </div>
                    <!-- Fim Botão Salvar -->
                    
            </form>
            <!-- Fim Formulário -->

            <!-- Rodapé -->
            <footer class="footer">
                <p>Moon Tools Sistemas e Tecnologia</p>
            </footer>
        </div>
    </body>    
</html>
